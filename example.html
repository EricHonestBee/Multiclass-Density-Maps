<!doctype html>
<html>
    <head>
        <title>Scalable Rendering of Multiclass Density Maps with Parser</title>
<style>
.example canvas {
  border: 1px solid grey;
}
bodyno {
  background-image:url('Baboon.png');
  background-repeat:repeat;
}
.example {
  font-weight: bold;
  float:left;
  margin:5px;
}
.clearBoth { clear:both; }

</style>
    </head>
    <body>
        <h1>Rendition</h1>

        <script src="https://d3js.org/d3-dsv.v1.min.js"></script>
        <script src="https://d3js.org/d3-fetch.v1.min.js"></script>
        <script src="dist/bundle.js" type="text/javascript"></script>
<script>
var mcp = new MCP.MCP(), prefix = "specs/";
var configuration, interpreter, canvasCount=0;

function render(desc, json, do_break, forcedWidth, forcedHeight) {
    var body = document.getElementsByTagName('body')[0],
        div = document.createElement("div"),
        canvas = document.createElement("canvas"),
        svg = document.createElementNS("http://www.w3.org/2000/svg", "svg"),
        id = "canvas"+(++canvasCount);

    div.classList.add("example");
    canvas.id = id;
    svg.id = id + '-legend';

    div.appendChild(document.createTextNode(desc));
    div.appendChild(document.createElement("br"));
    div.appendChild(canvas);
    div.appendChild(svg);


  body.appendChild(div);
  if (forcedWidth) {
    canvas.style.width = forcedWidth;
  }
  if (forcedHeight) {
    canvas.style.height = forcedHeight;
  }
  if (do_break) {
      var br = document.createElement("br");
      br.classList.add('clearBoth');
      body.appendChild(br);
  }
  var conf = mcp.create_configuration(json);
  conf.load('data/').then(function(conf) {
      interp = mcp.create_interp(conf);
      interp.setup(id);
      interpreter = interp;
      interp.interpret();
      interp.render(id);
      interp.renderLegend(id+'-legend');
  });
}

render('Linear Color Scale',
       {
           "description": "multivariate normal data",
           "data": {"url": "mn_data.json"},
           "compose": {
               "mix": "max",
               "mixing": "additive"
           }
       });

render('Log Color Scale',
       {
           "description": "multivariate normal data",
           "data": {"url": "mn_data.json"},
           "compose": {
               "mix": "max",
               "mixing": "additive"
           },
           "rescale": {
               "type": "log"
           }
       });

render('EquiDepth Color Scale (level=3, three colors should be shown)',
       {
           "description": "multivariate normal data",
           "data": {"url": "mn_data.json"},
           "compose": {
               "mix": "max",
               "mixing": "additive"
           },
           "rescale": {
               "type": "equidepth",
               "level": 3
           }
       });

render('EquiDepth Color Scale Small Multiples (level=4)',
       {
           "description": "multivariate normal data",
           "data": {"url": "mn_data.json"},
           "compose": {
               "mix": "separate" //, select: 1
           },
           "rescale": {
               "type": "equidepth",
               "level": 4
           }
       }, true);


render('Random Rectangular Weaving',
       {
           "description": "multivariate normal data",
           "data": {"url": "mn_data.json"},
           "compose": {
               "mix": "weavingrandom",
               "size": 8
           }
       });

render('Rectangular binning + circles',
       {
           "description": "multivariate normal data",
           "data": {"url": "mn_data.json"},
           "rebin": {
               "type": "square",
               "size": 32
           },
           /*"rescale": {
               "type": "log"
           },*/
           "compose": {
                "mix": "glyph",
                "glyphSpec": {
                    "template": "punchcard"
                }
            }
       });

render('Square Rectangular Weaving',
       {
           "description": "multivariate normal data",
           "data": {"url": "mn_data.json"},
           "compose": {
               "mix": "weavingsquare",
               "size": 8
           },
           "rescale": {
               "type": "linear"
           }
       });

render('Linear Color Scale hex',
       {
           "description": "multivariate normal data",
           "data": {"url": "mn_data.json"},
           "compose": {
               "mix": "weavinghex",
               "size": 8
           },
           "rescale": {
               "type": "linear"
           }
       });

render('EquiDepth Color Scale triangles',
       {
           "description": "multivariate normal data",
           "data": {"url": "mn_data.json"},
           "compose": {
               "mix": "weavingtri",
               "size": 8
           },
           "rescale": {
               "type": "equidepth"
           },
           "legend": {
               "numTicks": 4
           }
       }, true);

render('Census Data',
{
    "description": "US Census Synthetic people",
    "data": {"url": "census.snappy_data.json"},
    "reencoding": {
        "label": {
            "field": "z",
            "type": "nominal",
            "scale": {
                "domain": ["w", "h", "a", "b", "o"],
                "range": ["White", "Hispanic", "Asian", "Black", "Other"]
            }
        },
        "color": {
            "field": "z",
            "type": "nominal",
            "scale": {
                "range": ["Blue", "Orange", "Red", "Green", "Brown"]
            }
        }
    },
    "compose": {
        "mix": "mean",
        "mixing": "additive"
    },
    "rescale": {
        "type": "log"
    },
    "legend": {
        "labelWidth": 60
    }
});

render('Census Data Smoothed',
{
    "description": "US Census Synthetic people",
    "data": {"url": "census.snappy_data.json"},
    "smooth": {"radius": 1},
    "reencoding": {
        "label": {
            "field": "z",
            "type": "nominal",
            "scale": {
                "domain": ["w", "h", "a", "b", "o"],
                "range": ["White", "Hispanic", "Asian", "Black", "Other"]
            }
        },
        "color": {
            "field": "z",
            "type": "nominal",
            "scale": {
                "range": ["Blue", "Orange", "Red", "Green", "Brown"]
            }
        }
    },
    "compose": {
        "mix": "mean",
        "mixing": "additive"
    },
    "rescale": {
        "type": "log"
    },
    "legend": {
        "labelWidth": 60
    }
}, true);

render('Voronoi Tiling',
       {
           "description": "multivariate normal data",
           "data": {"url": "mn_data.json"},
           "rebin": {
               "type": "voronoi",
               "size": 32,
               "stroke": "black"
           },
           "compose": {
               "mix": "weavingrandom",
               "size": 4
           }
       });

render('Voronoi Tiling (Multicative)',{
    "description": "multivariate normal data",
    "data": {"url": "mn_data.json"},
    "smooth": {},
    "rebin": {
        "type": "voronoi",
        "size": 32,
        "stroke": "black"
    },
    "compose": {
        "mix": "blend",
        "mixing": "multicative"
    }
});

render('Voronoi Tiling + Prop. lines',
       {
           "description": "multivariate normal data",
           "data": {"url": "mn_data.json"},
           "rebin": {
               "type": "voronoi",
               "size": 32,
               "stroke": "black"
           },
           "compose": {
               "mix": "propline",
               "size": 4,
               "widthprop":"percent",
               "colprop":true
           }
       });
render('Voronoi Tiling + Hatching',
       {
           "description": "multivariate normal data",
           "data": {"url": "mn_data.json"},
           "rebin": {
               "type": "voronoi",
               "size": 32,
               "stroke": "black"
           },
           "compose": {
               "mix": "hatching",
               "size": 2,
               "widthprop":1.0,
               "colprop":false
           }
       }, true);

render('Voronoi Tiling (glyph - bars)',{
    "description": "multivariate normal data",
    "data": {"url": "mn_data.json"},
    "smooth": {},
    "rebin": {
        "type": "voronoi",
        "size": 32,
        "stroke": "black"
    },
    "compose": {
        "mix": "glyph",
        "glyphSpec": {
            "template": "bars",
            "width": 20,
            "height": 20
        }
    }
});

render('Census Data Random Weaving',
{
    "description": "US Census Synthetic people",
    "data": {"url": "census.snappy_data.json"},
    "reencoding": {
        "label": {
            "field": "z",
            "type": "nominal",
            "scale": {
                "domain": ["w", "h", "a", "b", "o"],
                "range": ["White", "Hispanic", "Asian", "Black", "Other"]
            }
        },
        "color": {
            "field": "z",
            "type": "nominal",
            "scale": {
                "range": ["Blue", "Orange", "Red", "Green", "Brown"]
            }
        }
    },
    "rebin": {
          "type": "topojson",
          "url": "us.json",
          "feature": "states",
          // "feature": "counties",
          /*"minfeature": 0,
          "maxfeature": 3109,*/
        //  "maxfeature": 49,
        //    "feature": "counties",
        //     "minfeature": 0,
        //   "maxfeature": 3109,
          "stroke": "rgba(0,0,0,0.25)"
    },
    "compose": {
          "mix": "weavingrandom",
          "size": 2
    },
    "rescale": {
        "type": "log"
    },
    "legend": {
        "labelWidth": 60
    }
});

render('Census Data Contour',
{
    "description": "US Census Synthetic people",
    "data": {"url": "census.snappy_data.json"},
    "reencoding": {
        "label": {
            "field": "z",
            "type": "nominal",
            "scale": {
                "domain": ["w", "h", "a", "b", "o"],
                "range": ["White", "Hispanic", "Asian", "Black", "Other"]
            }
        },
        "color": {
            "field": "z",
            "type": "nominal",
            "scale": {
                "range": ["Blue", "Orange", "Red", "Green", "Brown"]
            }
        }
    },
    "rebin": {
          "type": "topojson",
          "url": "us.json",
          /*"feature": "counties",
            "minfeature": 0,
          "maxfeature": 3100,*/
          "feature": "states",
          /*"minfeature": 0,
          "maxfeature": 49,*/
          "stroke": "grey"

    },
    "compose": {
          "mix": "none"
    },
    "rescale": {
        "type": "linear"
    },
    "contour": {
          "stroke": 12,
          "blur": 1
    },
    "legend": {
        "labelWidth": 60
    }
}, true);


</script>
    </body>
</html>
