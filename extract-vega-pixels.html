<!doctype html>
<html>
    <head>
        <title>Extract Pixels from Vega</title>
    </head>
    <body>
        <p>The extractor uses an in-memory dummy canvas. Image data will be printed in the console.</p>

        
        <div id="test"></div>

        <script src="dist/bundle.js" type="text/javascript"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega@3"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-lite@2"></script>
        <!-- Import vega-embed -->
        <script src="https://cdn.jsdelivr.net/npm/vega-embed@3"></script>
        <script>
            let spec = {
                "$schema": "https://vega.github.io/schema/vega-lite/v2.0.json",
                "description": "A simple bar chart with embedded data.",
                "data": {
                    "values": [
                        {"a": "A","b": 28}, {"a": "B","b": 55}, {"a": "C","b": 43},
                        {"a": "D","b": 91}, {"a": "E","b": 81}, {"a": "F","b": 53},
                        {"a": "G","b": 19}, {"a": "H","b": 87}, {"a": "I","b": 52}
                    ]
                },
                "mark": "bar",
                "encoding": {
                    "x": {"field": "a", "type": "ordinal"},
                    "y": {"field": "b", "type": "quantitative", scale: {domain: [0, 1000]}}
                },
                scales: [
                    {name: 'y', type: 'linear', domain: [0, 1000]}
                ],
                "autosize": "none",
                padding: 0,
                "config": {
                    "group": {
                        strokeWidth: 0
                    },
                    axis: {
                        ticks: false,
                        labels: false,
                        domain: false,
                        grid: false,
                        tickExtra: false,
                        gridColor: null
                    }
                },
                "width": 50,
                "height": 50
            }

            // let spec = {
            //     "$schema": "https://vega.github.io/schema/vega-lite/v2.0.json",
            //     "data": {
            //         "values": [
            //             {"a": "A", "b": 10, row: 0, col:0}, 
            //             {"a": "B", "b": 100, row: 0, col:1}, 
            //             {"a": "C", "b": 50, row: 1, col:0},
            //             {"a": "D", "b": 20, row: 1, col:1}/*, {"a": "E","b": 81}, {"a": "F","b": 53},
            //             {"a": "G","b": 19}, {"a": "H","b": 87}, {"a": "I","b": 52}*/
            //         ]
            //     },
            //     "mark": "circle",
            //     "encoding": {
            //         "x": {"field": "row", "type": "ordinal"},
            //         "y": {"field": "col", "type": "ordinal"},
            //         "size": {
            //             "field": "b",
            //             "type": "quantitative",
            //             // "aggregate": "sum",
            //             scale: {
            //                 domain: [0, 100]
            //             }
            //         },
            //     },
            //     "autosize": "none",
            //     padding: 0,
            //     "config": {
            //         "group": {
            //             strokeWidth: 0
            //         },
            //         axis: {
            //             ticks: false,
            //             labels: false,
            //             domain: false,
            //             grid: false,
            //             tickExtra: false,
            //             gridColor: null
            //         },
            //         mark: {
            //             opacity: 1
            //         }
            //     },
            //     "width": 50,
            //     "height": 50
            // }
            
            MCS.extract(spec).then((imageData) => {
                console.log(imageData);


            });
            
            vegaEmbed('#test', spec, {renderer: 'canvas', actions: false});
        </script>
    </body>
</html>
