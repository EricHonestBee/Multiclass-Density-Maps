<!doctype html>
<html>
    <head>
        <title>Scalable Rendering of Multiclass Density Maps with Parser</title>
<style>
.example canvas {
  border: 1px solid grey;
}
bodyno {
  background-image:url('Baboon.png');
  background-repeat:repeat;
}
.example {
  font-weight: bold;
  float:left;
  margin:5px;
}
.clearBoth { clear:both; }

</style>
    </head>
    <body>
        <h1>Rendition</h1>

        <script src="https://d3js.org/d3-dsv.v1.min.js"></script>
        <script src="https://d3js.org/d3-fetch.v1.min.js"></script>
        <script src="dist/bundle.js" type="text/javascript"></script>
<script>
var mcp = new MCP.MCP(), prefix = "specs/";
var configuration, interpreter, canvasCount=0;

function render(desc, json, do_break, forcedWidth, forcedHeight) {
    var body = document.getElementsByTagName('body')[0],
        div = document.createElement("div"),
        wrapper = document.createElement("div")

    div.classList.add("example");
    wrapper.classList.add("wrapper");

    
    div.appendChild(document.createTextNode(desc));
    div.appendChild(document.createElement("br"));
    div.appendChild(wrapper);

    body.appendChild(div);
    // if (forcedWidth) {
    //     canvas.style.width = forcedWidth;
    // }
    // if (forcedHeight) {
    //     canvas.style.height = forcedHeight;
    // }

    if (do_break) {
        var br = document.createElement("br");
        br.classList.add('clearBoth');
        body.appendChild(br);
    }

    var conf = mcp.create_configuration(json);
    conf.load('data/').then(function(conf) {
        interp = mcp.create_interp(conf);
        interp.interpret();
        interp.render(wrapper, forcedWidth, forcedHeight);
    //   interp.renderLegend(id+'-legend');
        console.log(interp);
    });
}

render('US Flight delays vs Distance for every day of the week - January 2017',
{
    "description": "US Flight delays vs Distance for every day of the week",
    "data": {"url": "223029297_T_ONTIME_1701_data.json"},
    "smooth": {},
    "reencoding": {
        "label": {
            "field": "z",
            "type": "nominal",
            "scale": {
                "domain": ["1", "2", "3", "4", "5", "6", "7"],
                "range": ["Monday", "Tuesday", "Wednesday", "Thrusday", "Friday", "Saturday", "Sunday"]
            }
        },
        "color": {
            "field": "z",
            "type": "nominal",
            "scale": {
                "range": ["Red", "Orange", "Pink", "Blue", "Brown", "Green", "Purple"]
            }
        }
    },

    "compose": {
        "mix": "max",
        "mixing": "additive"
    },
    "rescale": {
        "type": "cbrt"
    },
    "contour": {
        "blur": 2,
        "lineWidth":1,
        "colProp":false,
        "stroke": 4
    },
    "axis": true
}, false);

render('US Flight delays vs Distance for every day of the week - January 2017',
{
    "description": "US Flight delays vs Distance for every day of the week",
    "data": {"url": "223029297_T_ONTIME_1701_data.json"},
    "smooth": {},
    "reencoding": {
        "label": {
            "field": "z",
            "type": "nominal",
            "scale": {
                "domain": ["1", "2", "3", "4", "5", "6", "7"],
                "range": ["Monday", "Tuesday", "Wednesday", "Thrusday", "Friday", "Saturday", "Sunday"]
            }
        },
        "color": {
            "field": "z",
            "type": "nominal",
            "scale": {
                "range": ["Red", "Orange", "Pink", "Blue", "Brown", "Green", "Purple"]
            }
        }
    },

     "compose": {
         "mix": "max",
         "mixing": "additive"
     },
     "rescale": {
         "type": "cbrt"
     },
    "rebin": {
               "type": "voronoi",
               "size": 256,
               "stroke": "black"
           },
           "compose": {
               "mix": "propline",
               "size": 2,
               "widthprop":"percent",
               "colprop":true
           }

}, true);

render('US Flight air time vs speed for 3 main carriers = 2 Fekete items',
{
    "description": "US Flight Distance for every day of the week",
    "data": {"url": "flight_carriers2017_data.json"},
    "smooth": {},
    "reencoding": {

        "color": {
            "field": "z",
            "type": "nominal",
            "scale": {
                "range": ["Red", "Orange", "Pink", "Blue", "Brown", "Green", "Purple"]
            }
        }
    },
    "compose": {
         "mix": "max",
         "mixing": "additive"
     },
     "rescale": {
         "type": "cbrt"
     },
     "contour": {
      "blur": 2,
      "lineWidth":1,
      "colProp":false,
      "stroke": 4
    }


}, false);

render('US Flight delays vs Speed for every group of delays = 5.6 Fekete items',
{
    "description": "US Flight delays vs Distance for every day of the week",
    "data": {"url": "flight_delays2017_data.json"},
    "smooth": {},
    "reencoding": {

        "color": {
            "field": "z",
            "type": "nominal",
            "scale": {
                "range": ["Red", "Orange", "Pink", "Blue", "Brown", "Green", "Purple"]
            }
        }
    },
    "compose": {
         "mix": "max",
         "mixing": "additive"
     },
     "rescale": {
         "type": "cbrt"
     },
     "contour": {
      "blur": 2,
      "lineWidth":1,
      "colProp":false,
      "stroke": 4
    }


}, true);

</script>
    </body>
</html>
