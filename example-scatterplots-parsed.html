<!doctype html>
<html>
    <head>
        <title>Scalable Rendering of Multiclass Density Maps with Parser</title>
<style>
.example canvas {
  border: 1px solid grey;
}
bodyno {
  background-image:url('Baboon.png');
  background-repeat:repeat;
}
.example {
  font-weight: bold;
  float:left;
  margin:5px;
}
.clearBoth { clear:both; }

</style>
    </head>
    <body>
        <h1>Rendition</h1>

        <script src="https://d3js.org/d3-dsv.v1.min.js"></script>
        <script src="https://d3js.org/d3-fetch.v1.min.js"></script>
        <script src="dist/bundle.js" type="text/javascript"></script>
<script>
var mcp = new MCP.MCP(), prefix = "specs/";
var configuration, interpreter, canvasCount=0;

function render(desc, json, do_break, forcedWidth, forcedHeight) {
    var body = document.getElementsByTagName('body')[0],
        div = document.createElement("div"),
        canvas = document.createElement("canvas"),
        svg = document.createElementNS("http://www.w3.org/2000/svg", "svg"),
        id = "canvas"+(++canvasCount);

    div.classList.add("example");
    canvas.id = id;
    svg.id = id + '-legend';

    div.appendChild(document.createTextNode(desc));
    div.appendChild(document.createElement("br"));
    div.appendChild(canvas);
    div.appendChild(svg);


  body.appendChild(div);
  if (forcedWidth) {
    canvas.style.width = forcedWidth;
  }
  if (forcedHeight) {
    canvas.style.height = forcedHeight;
  }
  if (do_break) {
      var br = document.createElement("br");
      br.classList.add('clearBoth');
      body.appendChild(br);
  }
  var conf = mcp.create_configuration(json);
  conf.load('data/').then(function(conf) {
      interp = mcp.create_interp(conf);
      interp.setup(id);
      interpreter = interp;
      interp.interpret();
      interp.render(id);
      interp.renderLegend(id+'-legend');
  });
}



render('US Flight delays vs Distance for every day of the week - January 2017',
{
    "description": "US Flight delays vs Distance for every day of the week",
    "data": {"url": "223029297_T_ONTIME_1701_data.json"},
    "smooth": {},
    "reencoding": {
        "label": {
            "field": "z",
            "type": "nominal",
            "scale": {
                "domain": ["1", "2", "3", "4", "5", "6", "7"],
                "range": ["Sunday", "Monday", "Tuesday", "Wednesday", "Thrusday", "Friday", "Saturday"]
            }
        },
        "color": {
            "field": "z",
            "type": "nominal",
            "scale": {
                "range": ["Red", "Pink", "Blue", "Brown", "Green", "Purple", "Orange"]
            }
        }
    },

     "compose": {
         "mix": "max",
         "mixing": "additive"
     },
     "rescale": {
         "type": "sqrt"
     },
     "contour": {
      "blur": 3,
      "lineWidth":1,
      "colProp":false,
      "stroke": 4
    }

}, false);

render('US Flight delays vs Distance for every day of the week - January 2017',
{
    "description": "US Flight delays vs Distance for every day of the week",
    "data": {"url": "223029297_T_ONTIME_1701_data.json"},
    "smooth": {},
    "reencoding": {
        "label": {
            "field": "z",
            "type": "nominal",
            "scale": {
                "domain": ["1", "2", "3", "4", "5", "6", "7"],
                "range": ["Sunday", "Monday", "Tuesday", "Wednesday", "Thrusday", "Friday", "Saturday"]
            }
        },
        "color": {
            "field": "z",
            "type": "nominal",
            "scale": {
                "range": ["Red", "Pink", "Blue", "Brown", "Green", "Purple", "Orange"]
            }
        }
    },

     "compose": {
         "mix": "max",
         "mixing": "additive"
     },
     "rescale": {
         "type": "sqrt"
     },
    "rebin": {
               "type": "voronoi",
               "size": 256,
               "stroke": "black"
           },
           "compose": {
               "mix": "propline",
               "size": 2,
               "widthprop":"percent",
               "colprop":true
           }

}, true);

render('US Flight delays vs Distance for every day of the week - January 2017',
{
    "description": "US Flight delays vs Distance for every day of the week",
    "data": {"url": "223029297_T_ONTIME_1701_data.json"},
    "smooth": {},
    "reencoding": {
        "label": {
            "field": "z",
            "type": "nominal",
            "scale": {
                "domain": ["1", "2", "3", "4", "5", "6", "7"],
                "range": ["Sunday", "Monday", "Tuesday", "Wednesday", "Thrusday", "Friday", "Saturday"]
            }
        },
        "color": {
            "field": "z",
            "type": "nominal",
            "scale": {
                "range": ["Red", "Pink", "Blue", "Brown", "Green", "Purple", "Orange"]
            }
        }
    },
    "compose": {
         "mix": "weavingtri",
         "size": 8
     },
     "rescale": {
         "type": "equidepth"
     },


}, true);

</script>
    </body>
</html>
